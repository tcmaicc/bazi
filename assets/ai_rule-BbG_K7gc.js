import{_ as D,g as x,e as g,u as N,f as R,a as S,o as A,j as a,w as o,k as d,v as i,q as B,h as f,t as U,s as z,E as T,p as $,x as c}from"./index-DfQF0oAB.js";import{E as L,a as O,b as F}from"./el-table-column-m8NSn2qB.js";import{b as w}from"./route-block-B_A1xBdJ.js";import"./merge-C2MlVkhO.js";import"./flatMap-CVVhbvnp.js";import"./map-B6unp2GH.js";import"./_baseEach-CSgP2OB4.js";const M={class:"SubmitBtnDiv"},v={__name:"ai_rule",setup(j){let r=x().proxy;const s=g([]),l=N({Visible:!1,Data:{},Open:n=>{let e=s.value.find(u=>u.Id==n);e==="undefined"&&(e={Id:0,Name:"",SortNum:0,Value:"",Enable:!0}),l.Data={...e},l.Visible=!0},Close:()=>{l.Visible=!1},Submit:async n=>{let e={...l.Data};n&&(e.Id=0);let u=await r.Biz.Call("Admin_AiRule_Update",e);if(u.State){if(r.Util.Toast("操作成功"),e.Id==0)e.Id=u.Data,s.value.push(e);else{let m=s.value.findIndex(p=>p.Id==e.Id);s.value[m]=e}l.Close()}}}),V=async n=>{(await r.Biz.Call("Admin_AiRule_Enable",{Id:n.Id,Enable:!n.Enable})).State&&(n.Enable=!n.Enable,r.Util.Toast("操作成功"))},y=async n=>{!await r.Util.Confirm("确定删除吗？")||!(await r.Biz.Call("Admin_AiRule_Delete",{Id:n})).State||(s.value=s.value.filter(u=>u.Id!=n),r.Util.Toast("操作成功"))};return R(async()=>{if(!await r.Biz.AutoLogin())return;let n=await r.Biz.Call("Admin_AiRule_Get");n.State&&(s.value=n.Data)}),(n,e)=>{const u=B,m=O,p=L,E=F,_=$,b=T,I=z,k=c;return A(),S("div",null,[a(u,{type:"primary",onClick:e[0]||(e[0]=t=>i(l).Open(0))},{default:o(()=>e[7]||(e[7]=[d("添加",-1)])),_:1,__:[7]}),a(E,{data:s.value,stripe:"",fit:""},{default:o(()=>[a(p,{label:"启用",width:"60",align:"center"},{default:o(t=>[a(m,{type:t.row.Enable?"danger":"info",underline:!1,onClick:C=>V(t.row)},{default:o(()=>e[8]||(e[8]=[f("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",class:"ICON_Checkbox"},[f("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"})],-1)])),_:2,__:[8]},1032,["type","onClick"])]),_:1}),a(p,{prop:"Name",label:"名称"},{default:o(t=>[a(m,{type:t.row.Enable?"primary":"info",underline:!1,onClick:C=>i(l).Open(t.row.Id)},{default:o(()=>[d(U(t.row.Name),1)]),_:2},1032,["type","onClick"])]),_:1}),a(p,{label:"",width:"90",align:"center"},{default:o(t=>[a(m,{type:t.row.Checked?"danger":"info",onClick:C=>y(t.row.Id)},{default:o(()=>e[9]||(e[9]=[d("删除",-1)])),_:2,__:[9]},1032,["type","onClick"])]),_:1})]),_:1},8,["data"]),a(k,{modelValue:i(l).Visible,"onUpdate:modelValue":e[6]||(e[6]=t=>i(l).Visible=t),title:"编辑AI角色",top:"30px"},{default:o(()=>[f("div",null,[a(I,{model:i(l).Data,rules:n.rules,ref:"formRef","label-width":"120px"},{default:o(()=>[a(b,{label:"名称",prop:"Name"},{default:o(()=>[a(_,{modelValue:i(l).Data.Name,"onUpdate:modelValue":e[1]||(e[1]=t=>i(l).Data.Name=t)},null,8,["modelValue"])]),_:1}),a(b,{label:"排序",prop:"SortNum"},{default:o(()=>[a(_,{modelValue:i(l).Data.SortNum,"onUpdate:modelValue":e[2]||(e[2]=t=>i(l).Data.SortNum=t),type:"number",step:"1",min:"1",max:"100"},null,8,["modelValue"])]),_:1}),a(b,{label:"提示词",prop:"Value"},{default:o(()=>[a(_,{modelValue:i(l).Data.Value,"onUpdate:modelValue":e[3]||(e[3]=t=>i(l).Data.Value=t),type:"textarea",maxlength:-1,autosize:{minRows:2,maxRows:10}},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),f("div",M,[a(u,{type:"default",onClick:e[4]||(e[4]=t=>i(l).Submit(!0))},{default:o(()=>e[10]||(e[10]=[d("复制添加",-1)])),_:1,__:[10]}),a(u,{type:"primary",onClick:e[5]||(e[5]=t=>i(l).Submit(!1))},{default:o(()=>e[11]||(e[11]=[d("确定",-1)])),_:1,__:[11]}),a(u,{type:"danger",onClick:i(l).Close},{default:o(()=>e[12]||(e[12]=[d("取消",-1)])),_:1,__:[12]},8,["onClick"])])])]),_:1},8,["modelValue"])])}}};typeof w=="function"&&w(v);const W=D(v,[["__scopeId","data-v-851a96a8"]]);export{W as default};
