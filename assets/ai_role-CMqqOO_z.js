import{_ as x,g as T,e as R,m as U,f as A,a as B,o as E,j as a,w as o,k as p,u as n,v as N,h as C,t as b,p as P,q as L,s as S,x as z}from"./index-B7I5l2mx.js";import{E as c,a as $,b as H}from"./el-table-column-CbiQ7hMZ.js";import{b as w}from"./route-block-B_A1xBdJ.js";import"./merge-B621fjif.js";import"./flatMap-CCTw8kK3.js";import"./map-lXt_KhhD.js";import"./_baseEach-BxvR-3du.js";const O={class:"SubmitBtnDiv"},y={__name:"ai_role",setup(F){let d=T().proxy;const u=R([]),l=U({Visible:!1,Data:{},Open:i=>{let e=u.value.find(r=>r.Id==i);e==="undefined"&&(e={Id:0,Temperature:.7,TopP:.9,HistoryLength:1,Prompt:"你是一个资深的命理大师。",Checked:!1}),l.Data={...e},l.Visible=!0},Close:()=>{l.Visible=!1},Submit:async i=>{let e={...l.Data};i&&(e.Id=0);let r=await d.Biz.Call("Admin_AiRole_Update",e);if(r.State){if(d.Util.Toast("操作成功"),e.Id==0)e.Id=r.Data,e.Checked=!1,u.value.push(e);else{let m=u.value.findIndex(s=>s.Id==e.Id);u.value[m]=e}l.Close()}}}),v=async i=>{if(!await d.Util.Confirm("确定激活吗？")||!(await d.Biz.Call("Admin_AiRole_Checked",{Id:i})).State)return;let r=u.value.find(s=>s.Checked);r.Checked&&(r.Checked=!1);let m=u.value.find(s=>s.Id==i);m.Checked=!0,d.Util.Toast("操作成功")},V=async i=>{!await d.Util.Confirm("确定删除吗？")||!(await d.Biz.Call("Admin_AiRole_Delete",{Id:i})).State||(u.value=u.value.filter(r=>r.Id!=i),d.Util.Toast("操作成功"))};return A(async()=>{if(!await d.Biz.AutoLogin())return;let i=await d.Biz.Call("Admin_AiRole_Get");i.State&&(u.value=i.Data)}),(i,e)=>{const r=N,m=$,s=c,D=H,f=S,_=L,g=P,I=z;return E(),B("div",null,[a(r,{type:"primary",onClick:e[0]||(e[0]=t=>n(l).Open(0))},{default:o(()=>e[9]||(e[9]=[p("添加",-1)])),_:1,__:[9]}),a(D,{data:u.value,stripe:"",fit:""},{default:o(()=>[a(s,{label:"状态",width:"60",align:"center"},{default:o(t=>[a(m,{type:t.row.Checked?"danger":"info",underline:!1,onClick:k=>v(t.row.Id)},{default:o(()=>e[10]||(e[10]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",class:"ICON_Checkbox"},[C("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"})],-1)])),_:2,__:[10]},1032,["type","onClick"])]),_:1}),a(s,{prop:"Name",label:"名称"},{default:o(t=>[a(m,{type:t.row.Checked?"danger":"info",underline:!1,onClick:k=>n(l).Open(t.row.Id)},{default:o(()=>[p(b(t.row.Name),1)]),_:2},1032,["type","onClick"]),p(" （"+b(t.row.Temperature)+" / "+b(t.row.TopP)+" / "+b(t.row.HistoryLength)+"） ",1)]),_:1}),a(s,{label:"",width:"90",align:"center"},{default:o(t=>[a(m,{type:t.row.Checked?"danger":"info",onClick:k=>V(t.row.Id)},{default:o(()=>e[11]||(e[11]=[p("删除",-1)])),_:2,__:[11]},1032,["type","onClick"])]),_:1})]),_:1},8,["data"]),a(I,{modelValue:n(l).Visible,"onUpdate:modelValue":e[8]||(e[8]=t=>n(l).Visible=t),title:"编辑AI角色",top:"30px"},{default:o(()=>[C("div",null,[a(g,{model:n(l).Data,rules:i.rules,ref:"formRef","label-width":"120px"},{default:o(()=>[a(_,{label:"名称",prop:"Name"},{default:o(()=>[a(f,{modelValue:n(l).Data.Name,"onUpdate:modelValue":e[1]||(e[1]=t=>n(l).Data.Name=t)},null,8,["modelValue"])]),_:1}),a(_,{label:"温度",prop:"Temperature"},{default:o(()=>[a(f,{modelValue:n(l).Data.Temperature,"onUpdate:modelValue":e[2]||(e[2]=t=>n(l).Data.Temperature=t),type:"number",step:"0.1",min:"0",max:"2"},null,8,["modelValue"])]),_:1}),a(_,{label:"Top_P",prop:"TopP"},{default:o(()=>[a(f,{modelValue:n(l).Data.TopP,"onUpdate:modelValue":e[3]||(e[3]=t=>n(l).Data.TopP=t),type:"number",step:"0.1",min:"0",max:"1"},null,8,["modelValue"])]),_:1}),a(_,{label:"历史长度",prop:"HistoryLength"},{default:o(()=>[a(f,{modelValue:n(l).Data.HistoryLength,"onUpdate:modelValue":e[4]||(e[4]=t=>n(l).Data.HistoryLength=t),type:"number",step:"1",min:"1",max:"20"},null,8,["modelValue"])]),_:1}),a(_,{label:"提示词",prop:"Prompt"},{default:o(()=>[a(f,{modelValue:n(l).Data.Prompt,"onUpdate:modelValue":e[5]||(e[5]=t=>n(l).Data.Prompt=t),type:"textarea",maxlength:-1,autosize:{minRows:2,maxRows:10}},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),C("div",O,[a(r,{type:"default",onClick:e[6]||(e[6]=t=>n(l).Submit(!0))},{default:o(()=>e[12]||(e[12]=[p("复制添加",-1)])),_:1,__:[12]}),a(r,{type:"primary",onClick:e[7]||(e[7]=t=>n(l).Submit(!1))},{default:o(()=>e[13]||(e[13]=[p("确定",-1)])),_:1,__:[13]}),a(r,{type:"danger",onClick:n(l).Close},{default:o(()=>e[14]||(e[14]=[p("取消",-1)])),_:1,__:[14]},8,["onClick"])])])]),_:1},8,["modelValue"])])}}};typeof w=="function"&&w(y);const W=x(y,[["__scopeId","data-v-c84bab59"]]);export{W as default};
