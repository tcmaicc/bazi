import{_ as F,G as C,H,g as R,u as D,e as w,I as N,f as J,J as k,a as f,o as m,h as b,j as t,t as M,w as o,c as T,i as O,E as Q,K as W,L as j,M as q,z as I,F as v,m as h,A as K,y as Z,k as B,N as X,O as ee,q as le,s as ae,P as te,x as oe,D as ne,Q as re}from"./index-BunRc9Td.js";const se={class:"title"},ue={class:"container"},de={class:"date-time-group"},ie={class:"date-time-group"},me={__name:"m",setup(ce){C.locale(H);const d=R().proxy,_=D({Title:"",Aspects:["健康","学业","情感","财运","父母","子女","综合"]}),x=w(null),E=N(()=>window.innerWidth<768),a=D({calendarType:1,year:new Date("1981/09/04 23:30"),isLeap:!1,month:"8月",day:"8日",hour:"0时",minute:"0分",gender:0,region:["广东省","肇庆市","怀集县"],modules:[]}),V=w(""),y=w(!1),g=w(!1),L=()=>{try{let s=a.year.getFullYear(),l=parseInt(a.month),n=parseInt(a.day),u=parseInt(a.hour),r=parseInt(a.minute),i=null;a.calendarType===1?i=C.fromLunar({year:s,month:l,day:n,hour:u/2,isLeapMonth:a.isLeap}):i=C(new Date(`${s}/${l}/${n} ${u}:${r}:00`));let c=u<10?"0"+u:""+u,p=r<10?"0"+r:""+r;return{Birthday:i,Char8:i.format("cY cM cD cH"),LBirthday:i.format("lY年lMlDlH时（属cZ）"),SBirthday:i.format(`YYYY-M-D ${c}:${p}:00`)}}catch{return null}},A=async()=>{let s=L();if(!s)return d.Util.Alert("【出生时间】输入错误，请检查后重试");if(console.log(s.Char8,s.LBirthday,s.SBirthday),!a.modules||a.modules.length===0){k.warning("请至少选择一个测算模块");return}try{const l={Char8:s.Char8,LBirthday:s.LBirthday,SBirthday:s.SBirthday,Gender:a.gender,Modules:a.modules};let n="";V.value="",y.value=!0,g.value=!0,d.Biz.Chat(l,async u=>{if(!u.State){k.error(u.Msg),y.value=!1,g.value=!1;return}let r=u.Data;if(r.IsCompleted){V.value=r.Reply,re(async()=>{d.JsInvoke.PrintPDF(x.value.outerHTML),y.value=!1});return}r.Content&&(n+=r.Content||"",n!=""&&n.indexOf("```markdown")===0&&(n=n.replace("```markdown","")),V.value=n)})}catch(l){console.error("提交失败:",l),k.error("提交失败，请检查网络后重试")}finally{y.value=!1}};J(async()=>{let s=d.Util.GetQueryParam("code"),l=d.Util.GetQueryParam("userid"),n=s&&l?{code:s,userid:l}:null;if(!await d.JsInvoke._Start(n)){k.error("应用初始化失败，请重启应用");return}_.Title=d.Global.Config.Title||"八字命理",_.Aspects=d.Global.Config.Aspects.split(",")||_.Aspects,window.addEventListener("resize",U)});function U(){E.value=window.innerWidth<768}return(s,l)=>{const n=j,u=W,r=Q,i=q,c=K,p=I,S=Z,Y=ee,G=X,P=le,$=ae,z=oe;return m(),f("div",{class:"no-select",onContextmenu:l[10]||(l[10]=ne(()=>{},["prevent"]))},[b("div",se,M(_.Title),1),b("div",ue,[t($,{class:"form",ref:"formRef","label-width":"auto",model:a,inline:!E.value,size:"large"},{default:o(()=>[t(r,{label:"历法"},{default:o(()=>[t(u,{modelValue:a.calendarType,"onUpdate:modelValue":l[0]||(l[0]=e=>a.calendarType=e),fill:"#9E2A2B"},{default:o(()=>[t(n,{label:"公历",value:0}),t(n,{label:"农历",value:1})]),_:1},8,["modelValue"])]),_:1}),t(r,{label:"生日"},{default:o(()=>[b("div",de,[t(i,{modelValue:a.year,"onUpdate:modelValue":l[1]||(l[1]=e=>a.year=e),type:"year",format:"YYYY年",placeholder:"年份",clearable:!1,style:{width:"7rem"}},null,8,["modelValue"]),t(p,{modelValue:a.month,"onUpdate:modelValue":l[2]||(l[2]=e=>a.month=e),placeholder:"月份",clearable:!1,style:{width:"5.5rem"}},{default:o(()=>[(m(),f(v,null,h([1,2,3,4,5,6,7,8,9,10,11,12],e=>t(c,{key:e,label:e+"月",value:e},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),t(p,{modelValue:a.day,"onUpdate:modelValue":l[3]||(l[3]=e=>a.day=e),placeholder:"日期",clearable:!1,style:{width:"5.5rem"}},{default:o(()=>[(m(),f(v,null,h([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],e=>t(c,{key:e,label:e+"日",value:e},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])]),_:1}),t(r,{label:"时间"},{default:o(()=>[b("div",ie,[t(p,{modelValue:a.hour,"onUpdate:modelValue":l[4]||(l[4]=e=>a.hour=e),placeholder:"小时",clearable:!1,style:{width:"6rem"}},{default:o(()=>[(m(),f(v,null,h([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],e=>t(c,{key:e,label:e+"时",value:e},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),t(p,{modelValue:a.minute,"onUpdate:modelValue":l[5]||(l[5]=e=>a.minute=e),placeholder:"分钟",clearable:!1,style:{width:"6rem"}},{default:o(()=>[(m(),f(v,null,h([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],e=>t(c,{key:e,label:e+"分",value:e},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])]),_:1}),a.calendarType===1?(m(),T(r,{key:0,label:"润月"},{default:o(()=>[t(S,{modelValue:a.isLeap,"onUpdate:modelValue":l[6]||(l[6]=e=>a.isLeap=e),style:{"--el-switch-on-color":"#9E2A2B"},"true-label":!0,"false-label":!1},null,8,["modelValue"])]),_:1})):O("",!0),t(r,{label:"性别"},{default:o(()=>[t(u,{modelValue:a.gender,"onUpdate:modelValue":l[7]||(l[7]=e=>a.gender=e),fill:"#9E2A2B"},{default:o(()=>[t(n,{label:"男",value:0},{default:o(()=>l[11]||(l[11]=[B("男",-1)])),_:1,__:[11]}),t(n,{label:"女",value:1},{default:o(()=>l[12]||(l[12]=[B("女",-1)])),_:1,__:[12]})]),_:1},8,["modelValue"])]),_:1}),t(r,{label:"模块"},{default:o(()=>[t(G,{modelValue:a.modules,"onUpdate:modelValue":l[8]||(l[8]=e=>a.modules=e),class:"module-checkbox-group",fill:"#9E2A2B"},{default:o(()=>[(m(!0),f(v,null,h(_.Aspects,e=>(m(),T(Y,{key:e,label:e,class:"module-checkbox"},{default:o(()=>[B(M(e),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(P,{onClick:A,color:"#9E2A2B",loading:y.value,class:"submit-btn"},{default:o(()=>l[13]||(l[13]=[B(" 开始测算 ",-1)])),_:1,__:[13]},8,["loading"])]),_:1},8,["model","inline"])]),t(z,{modelValue:g.value,"onUpdate:modelValue":l[9]||(l[9]=e=>g.value=e),title:"测算结果",width:E.value?"95%":"80%",height:"100%","lock-scroll":!1,"close-on-click-modal":!1,"close-on-press-escape":!0,"show-close":!0,"destroy-on-close":!0},{default:o(()=>[b("div",{class:"ReplyDiv",ref_key:"MdTag",ref:x},[t(te,{text:V.value,"scroll-to-bottom":!0},null,8,["text"])],512)]),_:1},8,["modelValue","width"])],32)}}},fe=F(me,[["__scopeId","data-v-8958d5eb"]]);export{fe as default};
