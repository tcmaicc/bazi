import{_ as U,g as x,e as P,u as R,f as E,a as N,o as S,j as t,w as n,k as f,v as o,q as B,h as C,t as T,s as M,E as O,p as z,y as H,z as $,A as K,x as L}from"./index-HSH-XvG9.js";import{E as F,a as j,b as q}from"./el-table-column-CsfdUxf_.js";import{b as k}from"./route-block-B_A1xBdJ.js";import"./merge-CiRgrBfv.js";import"./flatMap-DPdAE9Zq.js";import"./map-CCECNVDo.js";import"./_baseEach-Ux_EUMOI.js";const G={class:"SubmitBtnDiv"},v={__name:"ai_model",setup(J){let s=x().proxy;const u=P([]),a=R({Visible:!1,Data:{},Open:d=>{let e=u.value.find(i=>i.Id==d);e==="undefined"&&(e={Id:0,Name:"OpenRouter_Deepseek_V3-0324",Model:"deepseek/deepseek-chat-v3-0324:free",IsReasoning:!1,APIUrl:"https://openrouter.ai/api/v1/chat/completions",APIKey:"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",CustomHeads:"{}",APIType:0,Checked:!1}),a.Data={...e},a.Visible=!0},Close:()=>{a.Visible=!1},Submit:async d=>{let e={...a.Data};e.CustomHeads=e.CustomHeads||"{}";try{let r=JSON.parse(e.CustomHeads)}catch{s.Util.Toast("自定义头部格式错误");return}d&&(e.Id=0);let i=await s.Biz.Call("Admin_AiModel_Update",e);if(i.State){if(s.Util.Toast("操作成功"),e.Id==0)e.Id=i.Data,e.Checked=!1,u.value.push(e);else{let r=u.value.findIndex(p=>p.Id==e.Id);u.value[r]=e}a.Close()}}}),V=async d=>{if(!await s.Util.Confirm("确定激活吗？")||!(await s.Biz.Call("Admin_AiModel_Checked",{Id:d})).State)return;let i=u.value.find(p=>p.Checked);i.Checked&&(i.Checked=!1);let r=u.value.find(p=>p.Id==d);r.Checked=!0,s.Util.Toast("操作成功")},b=async d=>{!await s.Util.Confirm("确定删除吗？")||!(await s.Biz.Call("Admin_AiModel_Delete",{Id:d})).State||(u.value=u.value.filter(i=>i.Id!=d),s.Util.Toast("操作成功"))};return E(async()=>{if(!await s.Biz.AutoLogin())return;let d=await s.Biz.Call("Admin_AiModel_Get");d.State&&(u.value=d.Data)}),(d,e)=>{const i=B,r=j,p=F,y=q,_=z,m=O,D=H,w=K,A=$,c=M,g=L;return S(),N("div",null,[t(i,{type:"primary",onClick:e[0]||(e[0]=l=>o(a).Open(0))},{default:n(()=>e[11]||(e[11]=[f("添加",-1)])),_:1,__:[11]}),t(y,{data:u.value,stripe:"",fit:""},{default:n(()=>[t(p,{label:"状态",width:"60",align:"center"},{default:n(l=>[t(r,{type:l.row.Checked?"danger":"info",underline:!1,onClick:I=>V(l.row.Id)},{default:n(()=>e[12]||(e[12]=[C("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",class:"ICON_Checkbox"},[C("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"})],-1)])),_:2,__:[12]},1032,["type","onClick"])]),_:1}),t(p,{prop:"Name",label:"名称"},{default:n(l=>[t(r,{type:l.row.Checked?"danger":"info",underline:!1,onClick:I=>o(a).Open(l.row.Id)},{default:n(()=>[f(T(l.row.Name),1)]),_:2},1032,["type","onClick"])]),_:1}),t(p,{label:"",width:"90",align:"center"},{default:n(l=>[t(r,{type:l.row.Checked?"danger":"info",onClick:I=>b(l.row.Id)},{default:n(()=>e[13]||(e[13]=[f("删除",-1)])),_:2,__:[13]},1032,["type","onClick"])]),_:1})]),_:1},8,["data"]),t(g,{modelValue:o(a).Visible,"onUpdate:modelValue":e[10]||(e[10]=l=>o(a).Visible=l),title:"编辑AI模型",top:"30px"},{default:n(()=>[C("div",null,[t(c,{model:o(a).Data,rules:d.rules,ref:"formRef","label-width":"120px"},{default:n(()=>[t(m,{label:"名称",prop:"Name"},{default:n(()=>[t(_,{modelValue:o(a).Data.Name,"onUpdate:modelValue":e[1]||(e[1]=l=>o(a).Data.Name=l)},null,8,["modelValue"])]),_:1}),t(m,{label:"模型",prop:"Model"},{default:n(()=>[t(_,{modelValue:o(a).Data.Model,"onUpdate:modelValue":e[2]||(e[2]=l=>o(a).Data.Model=l)},null,8,["modelValue"])]),_:1}),t(m,{label:"是否推理",prop:"IsReasoning"},{default:n(()=>[t(D,{modelValue:o(a).Data.IsReasoning,"onUpdate:modelValue":e[3]||(e[3]=l=>o(a).Data.IsReasoning=l),"active-value":"true","inactive-value":"false"},null,8,["modelValue"])]),_:1}),t(m,{label:"API地址",prop:"APIUrl"},{default:n(()=>[t(_,{modelValue:o(a).Data.APIUrl,"onUpdate:modelValue":e[4]||(e[4]=l=>o(a).Data.APIUrl=l)},null,8,["modelValue"])]),_:1}),t(m,{label:"API密钥",prop:"APIKey"},{default:n(()=>[t(_,{modelValue:o(a).Data.APIKey,"onUpdate:modelValue":e[5]||(e[5]=l=>o(a).Data.APIKey=l)},null,8,["modelValue"])]),_:1}),t(m,{label:"自定义头部",prop:"CustomHeads"},{default:n(()=>[t(_,{modelValue:o(a).Data.CustomHeads,"onUpdate:modelValue":e[6]||(e[6]=l=>o(a).Data.CustomHeads=l),type:"textarea",maxlength:-1,autosize:{minRows:2,maxRows:10}},null,8,["modelValue"])]),_:1}),t(m,{label:"API类型",prop:"APIType"},{default:n(()=>[t(A,{modelValue:o(a).Data.APIType,"onUpdate:modelValue":e[7]||(e[7]=l=>o(a).Data.APIType=l)},{default:n(()=>[t(w,{label:"OpenRouter",value:"0"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),C("div",G,[t(i,{type:"default",onClick:e[8]||(e[8]=l=>o(a).Submit(!0))},{default:n(()=>e[14]||(e[14]=[f("复制添加",-1)])),_:1,__:[14]}),t(i,{type:"primary",onClick:e[9]||(e[9]=l=>o(a).Submit(!1))},{default:n(()=>e[15]||(e[15]=[f("确定",-1)])),_:1,__:[15]}),t(i,{type:"danger",onClick:o(a).Close},{default:n(()=>e[16]||(e[16]=[f("取消",-1)])),_:1,__:[16]},8,["onClick"])])])]),_:1},8,["modelValue"])])}}};typeof k=="function"&&k(v);const le=U(v,[["__scopeId","data-v-54ee2258"]]);export{le as default};
